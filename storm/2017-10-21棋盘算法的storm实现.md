# 极小化极大值算法

## 基本算法思想
极小化极大（minimax）算法顾名思义，就是让最大得情况最小，这里的最大一般是指最差的情况，比如游戏中最不利的情况。

该算法需要满足零和博弈，初略的解释就是若有两个玩家进行游戏，如果其中一方得到利益那么另一方就会失去利益，游戏利益的总和为0（某些情况下为常数）。
因此，零和的约束条件也使得该算法在很多游戏中图体现出很好的效果，比如大多数的棋类游戏。

其实说白了，这个算法就是一个树形结构的递归算法，每个节点的孩子和父节点都是对方玩家，所有的节点被分为极大值（我方）节点和极小值（对方）节点

算法思想参考维基的伪代码：
```java
function minimax(node, depth)
    if node is a terminal node or depth = 0
        return the heuristic value of node
    if the adversary is to play at node
        let α := +∞
        foreach child of node
            α := min(α, minimax(child, depth-1))
    else {we are to play at node}
        let α := -∞
        foreach child of node
            α := max(α, minimax(child, depth-1))
    return α
```
上述代码depth是最多预测层数限制，函数递归有两个出口，一是到达层数限制即depth 为 0，二是已经递归到叶子节点，在游戏中体现为“死棋“或者有一方已经确定胜利获失败。

下面的两个迭代过程需要进行玩家判断，因为我们需要最小话敌方的优势（最大化我方优势），所以对应敌方的当前步，需要返回找到的min；我方的当前步，需要返回找到的max。

与此同时，迭代本身体现在我们假设对方也做出了在我们已经考虑到的范围内（同样想到了这层策略）的最佳判断，因为游戏通常是双方交替进行的，所以通常在实际编程中我们还要给minimax方法中添加一个确认当前玩家身份的参数，如果只有两个玩家布朗型可能是一个较好的选择。

每次的迭代，都可以认为是向上一层的预测，当然，因为minimax的算法是树形结构，不断地向下拓展该树会导致计算量的倍数增加（多少倍取决于所剩可选的当前支孩子节点的数量）。但是有可能会出现一种情况，当函数递归到一定层数（计算量达到一定数值后），所剩可选分支已经很少（很多已经到达叶子节点），可继续递归的子节点数量也相应减少，反而高层级的预测计算量并不大。当然通常情况是在还没到达这个极值之前，计算机已经无法在可以接受的时间内进行玩这些计算了，比如围棋。

其实可以用alpha-beta 剪枝算法进行改进，这里我们只谈极小化极大值算法。

# 井字棋游戏

3x3的棋盘，算法实现伪代码：
```java
public int miniMax(board,depth,maximizing){
	if(depth <= 0){
		return score(board);
	}else{
		children = move(board);//找到当前状态下所有可行步骤的棋盘状态
		if(maximizing){//计算最大化值
			bestValue = -∞;
			for(child:children){//遍历所有可能的子节点的棋盘状态
				value = miniMax(child,depth-1,false);
				if(value > bestValue){//找到分值最高的格子
					bestValue = value;
				}
			}
			return bestValue;
		}else{//计算最小化值
			bestValue = ∞;
			for(child:children){
				value = miniMax(child,depth-1,false);
				if(value < bestValue){
					bestValue = value;
				}
			}
			return bestValue;
		}
	}
}
public int move(board){
	//计算当前节点的子节点的所有可能状态
	//三水平，三垂直，两对角线
}
```
![极大值][1]

其中用到了递归的思想，然而内部的值逐渐返回给上层。对于Storm和Trident来说，topology中不提供访问下游function结果的机制，因此我们必须将`调用栈`用祖先节点列表的形式维护起来。


  [1]: ./images/1508568724988.jpg